<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>付款成功页面</title>
    <link rel="stylesheet" type="text/css" href="./static/css/amazeui.css"/>
    <link href="./static/css/admin.css" rel="stylesheet" type="text/css">
    <link href="./static/css/demo.css" rel="stylesheet" type="text/css"/>
    <link href="./static/css/sustyle.css" rel="stylesheet" type="text/css"/>

    <!--    <script type="text/javascript" src="./static/js/jquery-1.7.min.js"></script>-->
</head>

<body>
<div id="app">
    <!--顶部导航条 -->
    <div class="am-container header">
        <ul class="message-l">
            <div class="topMessage">
                <div v-if="isLogin" class="menu-hd">
                    <span class="h">欢迎, {{userInfo.nickname}}</span>
                    &nbsp;&nbsp;
                    <a @click.prevent="logout" href="#" target="_top">退出登录</a>
                </div>
                <div v-else class="menu-hd">
                    <a href="login.html" target="_top" class="h">亲，请登录</a>
                    &nbsp;&nbsp;
                    <a href="register.html" target="_top">免费注册</a>
                </div>
            </div>
        </ul>
        <ul class="message-r">
            <div class="topMessage home">
                <div class="menu-hd">
                    <a href="index.html" target="_top" class="h">商城首页</a>
                </div>
            </div>
            <div class="topMessage my-shangcheng">
                <div class="menu-hd MyShangcheng">
                    <a href="user-center.html" target="_top">
                        <i class="am-icon-user am-icon-fw"></i>
                        个人中心
                    </a>
                </div>
            </div>
            <div class="topMessage mini-cart">
                <div class="menu-hd">
                    <a id="mc-menu-hd" href="#" target="_top">
                        <i class="am-icon-shopping-cart  am-icon-fw"></i>
                        <span>购物车</span>
<!--                        <strong id="J_MiniCartNum" class="h">0</strong>-->
                    </a>
                </div>
            </div>
            <div class="topMessage favorite">
                <div class="menu-hd">
                    <!--<a href="#" target="_top">
                        <i class="am-icon-heart am-icon-fw"></i>
                        <span>收藏夹</span>
                    </a>-->
                </div>
            </div>
        </ul>
    </div>

    <!--悬浮搜索框-->
    <div class="nav white">
        <div class="logo"><img src="./static/images/logo.png"/></div>
        <div class="logoBig">
            <li><img src="./static/images/logobig.png"/></li>
        </div>

        <div class="search-bar pr">
            <a name="index_none_header_sysc" href="#"></a>
            <form>
                <input @keyup.prevent.enter="toSearchPage"
                       v-model="searchKeyWord"
                       id="searchInput"
                       name="index_none_header_sysc"
                       type="text"
                       placeholder="搜索"
                       autocomplete="off">
                <input @click.prevent="toSearchPage"
                       id="ai-topsearch"
                       class="submit am-btn"
                       value="搜索"
                       index="1"
                       type="submit">
            </form>
        </div>
    </div>
    <div class="clear"></div>

    <div class="take-delivery">
        <div class="status">
            <h2>您已成功付款</h2>
            <div class="successInfo">
                <ul>
                    <li>付款金额
                        <em style="font-size: 20px;">¥{{order.actualAmount}}</em>
                    </li>
                    <div class="user-info">
                        <p>收货人：{{order.receiverName}}</p>
                        <p>联系电话：{{order.receiverMobile}}</p>
                        <p>收货地址：{{order.receiverAddress}}</p>
                        <p>订单编号：{{order.orderId}}</p>
                        <p>订单内容: {{order.untitled}}</p>
                        <p>订单创建时间：{{order.createTime}}</p>
                        <p>订饭支付时间：{{order.payTime}}</p>
                    </div>
                    请认真核对您的收货信息，如有错误请联系客服

                </ul>
                <div class="option">
                    <span class="info">您可以</span>
                    <a href="user-orderlist.html?status=2" class="J_MakePoint">查看<span>已买到的宝贝</span></a>
                    <a href="index.html" class="J_MakePoint">继续购买<span>回首页</span></a>
                </div>
            </div>
        </div>
    </div>

    <div class="footer">
        <div class="footer-hd ">
            <p>
                <a style="pointer-events: none;" href="#">潘氏商城</a>
                <b>|</b>
                <a style="pointer-events: none;" href="#">商城首页</a>
                <b>|</b>
                <a style="pointer-events: none;" href="#">个人中心</a>
                <b>|</b>
                <a style="pointer-events: none;" href="#">物流</a>
            </p>
        </div>
        <div class="footer-bd ">
            <p>
                <a style="pointer-events: none;" href="#">关于商城</a>
                <a style="pointer-events: none;" href="#">合作伙伴</a>
                <a style="pointer-events: none;" href="#">联系我们</a>
                <a style="pointer-events: none;" href="#">网站地图</a>
                <em>©pandemo.top 版权所有</em>
            </p>
        </div>
    </div>

</div>

<script type="text/javascript" src="./static/js/vue.js"></script>
<script type="text/javascript" src="./static/js/axios.min.js"></script>
<script type="text/javascript" src="./static/elementui/index.js"></script>
<script type="text/javascript" src="./static/utils/handleError.js"></script>
<script type="text/javascript" src="./static/utils/utils.js"></script>
<script type="text/javascript" src="./static/js/dayjs.min.js"></script>
<script type="text/javascript" src="./static/utils/base.js"></script>

<script type="text/javascript">
    axios.defaults.baseURL = baseUrl;
    axios.interceptors.request.use(
        config => {
            config.headers.Authorization = localStorage.getItem('token');

            return config;
        }
    );


    const vm = new Vue({
        el: '#app',
        data() {
            return {
                userInfo: {
                    nickname: localStorage.getItem('nickname'),
                    userImg: localStorage.getItem('userImg')
                },
                isLogin: localStorage.getItem('token') !== null,
                order: {},
                searchKeyWord:''
            }
        },
        computed: {
            urlParam() {
                return getUrlParam(window.location.href);
            },
            qrcodeClass() {
                if (this.order.payType === 1) {
                    return 'border-green';
                } else if (this.order.payType === 2) {
                    return 'border-blue';
                } else {
                    return 'border-default'
                }
            }
        },
        methods: {
            /*退出*/
            logout() {
                localStorage.removeItem('token');
                localStorage.removeItem('userId');
                localStorage.removeItem('nickname');
                localStorage.removeItem('userImg');
                this.isLogin = false;
                window.location.href = 'login.html';
            },

            /*获取订单信息*/
            async getOrder() {
                const {data: res} = await axios.get(`order/${this.urlParam.orderId}`);

                if (!handleCode(res.code, res.msg)) {
                    return;
                }

                this.order = res.data.order;
                this.order.createTime = dayjs(this.order.createTime).format('YYYY-MM-DD HH:mm:ss');
                this.order.payTime = dayjs(this.order.payTime).format('YYYY-MM-DD HH:mm:ss');
            },

            /*单击搜索进入搜索页*/
            toSearchPage() {
                if (this.searchKeyWord != null && this.searchKeyWord !== '') {
                    window.location.href = `search.html?query=${this.searchKeyWord}`;
                } else {
                    this.$message.error({message: '请输入关键字再搜索', center: true});
                }
            }
        },
        mounted() {
            this.getOrder();

            this.$nextTick(() => {
                loadJS('./static/js/jquery-1.7.min.js');
            });
        }
    });
</script>


</body>
</html>
